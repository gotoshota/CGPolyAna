\chapter{Fortran module}
\hypertarget{md__2home_2prose_2wrk_2CGPolyAna_2src_2LammpsDumpReader_2fortran_2README}{}\label{md__2home_2prose_2wrk_2CGPolyAna_2src_2LammpsDumpReader_2fortran_2README}\index{Fortran module@{Fortran module}}
\label{md__2home_2prose_2wrk_2CGPolyAna_2src_2LammpsDumpReader_2fortran_2README_autotoc_md0}%
\Hypertarget{md__2home_2prose_2wrk_2CGPolyAna_2src_2LammpsDumpReader_2fortran_2README_autotoc_md0}%
テストコードは、{\ttfamily test/main.\+f90}にありますが、簡単に説明します。

構造体（クラス）{\ttfamily lammpatrj\+Reader}を提供します。 このクラスは、\+LAMMPSのトラジェクトリファイルを読み込み、 原子の座標などを取得することができます。

スナップショット1毎ずつ情報を取得するため、 トラジェクトリを一気に読み込む必要がある場合には、別途配列を用意して格納するか、 うまくアルゴリズムを工夫してください。

lammpsのダンプファイルはデータの書き出し順などフォーマットが結構自由なため、 内部でヘッダーをパースして、データ部分を読み込むようになっています。 そのせいか少し遅く、毎秒5フレーム程度の読み込み速度です。\hypertarget{md__2home_2prose_2wrk_2CGPolyAna_2src_2LammpsDumpReader_2fortran_2README_autotoc_md1}{}\doxysection{\texorpdfstring{構造体のメンバ変数}{構造体のメンバ変数}}\label{md__2home_2prose_2wrk_2CGPolyAna_2src_2LammpsDumpReader_2fortran_2README_autotoc_md1}
主要なものだけを紹介。
\begin{DoxyItemize}
\item {\ttfamily filename} \+: トラジェクトリのファイル名
\item {\ttfamily nparticles} \+: 総粒子数。ヘッダーの NUMBER OF ATOMS と同じ
\item {\ttfamily box\+\_\+bounds} \+: (3, 3) の倍精度実数配列。ボックスの境界条件。各軸の最小値{\ttfamily box\+\_\+bounds(1, \+:)}、最大値{\ttfamily box\+\_\+bounds(2, \+:)}、傾き {\ttfamily box\+\_\+bounds(3, \+:)}に格納されている。2列目は順にx, y, zに対応している。
\item {\ttfamily coords}\+: (3, nparticles) の単精度実数配列。座標が格納されている。
\item {\ttfamily image\+\_\+flags} \+: (3, nparticles) の整数配列。イメージフラグが格納されている。 
\end{DoxyItemize}